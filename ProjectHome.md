Working on the code for the detector